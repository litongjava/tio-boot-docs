# Python ä½¿ç”¨ Modal GPU åŠ é€Ÿæ¸²æŸ“

æœ¬æ–‡ä»‹ç»å¦‚ä½•åˆ©ç”¨ [Modal.com](https://modal.com/) çš„äº‘ç«¯ GPU æœåŠ¡ï¼Œå¿«é€Ÿéƒ¨ç½²å¹¶è¿è¡Œ Python æ¸²æŸ“ä»»åŠ¡ã€‚æ–‡ä¸­ä¸ä»…å¯¹ Modal.com çš„ GPU æœåŠ¡åšäº†ç®€å•ä»‹ç»ï¼Œè¿˜æä¾›äº†ä»å®‰è£… CLIã€åˆ›å»ºåº”ç”¨ã€å®šåˆ¶å®¹å™¨ï¼Œåˆ°æ°´å¹³æ‰©å±•ä»¥åŠ GPU åŠ é€Ÿè¿è¡Œçš„å…¨æµç¨‹ç¤ºä¾‹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½ä¼šç¨æ…¢ï¼Œä½†ä¹‹åçš„è¿è¡Œé€Ÿåº¦ä¼šæ˜¾è‘—æå‡ã€‚

---

## ä¸€ã€Modal.com GPU ç®€ä»‹

Modal.com æä¾›äº†ä¸€å¥—æ˜“äºä½¿ç”¨çš„äº‘ç«¯å®¹å™¨åŒ–è®¡ç®—ç¯å¢ƒï¼Œæ”¯æŒ CPU ä¸ GPU æœåŠ¡å™¨ï¼Œéå¸¸é€‚åˆ AI æ¨¡å‹è®­ç»ƒã€å›¾åƒå¤„ç†ã€è§†é¢‘æ¸²æŸ“ç­‰ä»»åŠ¡çš„å¿«é€Ÿéƒ¨ç½²ã€‚å…¶ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

- **é«˜æ€§èƒ½ GPU æ”¯æŒ**ï¼šModal æä¾› A100ã€V100ã€T4 ç­‰å¤šç§é«˜æ€§èƒ½ GPUï¼Œæ»¡è¶³å„ç§è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„éœ€æ±‚ã€‚
- **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šå€ŸåŠ©å®¹å™¨æŠ€æœ¯ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºã€é…ç½®å’Œéƒ¨ç½²æ‰€éœ€çš„è¿è¡Œç¯å¢ƒã€‚
- **è‡ªåŠ¨æ‰©å±•**ï¼šModal èƒ½å¤Ÿæ ¹æ®ä»»åŠ¡éœ€æ±‚è‡ªåŠ¨æ‰©å±•è®¡ç®—èµ„æºï¼Œè½»æ¾åº”å¯¹å¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—ä»»åŠ¡ã€‚

---

## äºŒã€åœ¨ Modal ä¸Šéƒ¨ç½² GPU æ¸²æŸ“ï¼ˆOpenGLï¼‰ç¤ºä¾‹æ•™ç¨‹

ä¸‹é¢é€šè¿‡ä¸€ç³»åˆ—ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ Modal ä¸Šéƒ¨ç½²å¹¶åŠ é€Ÿæ¸²æŸ“ä»»åŠ¡ã€‚

### 1. å®‰è£… Modal CLI å¹¶ç™»å½•

é¦–å…ˆï¼Œéœ€è¦åœ¨æœ¬åœ°å®‰è£… Modal CLI å¹¶è¿›è¡Œç™»å½•ã€‚å¯ä»¥ä½¿ç”¨ pip å®‰è£…å¹¶ç™»å½•ï¼š

```bash
pip install modal
modal login
```

æˆ–è€…ä½¿ç”¨ token æ–¹å¼ç™»å½•ï¼š

```bash
modal token set --token-id id --token-secret secret
```

---

### 2. å…¥é—¨ç¤ºä¾‹

#### 2.1 è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªå‡½æ•°

Modal ä½¿å¾—ä»£ç éƒ¨ç½²ä¸æ‰©å±•å˜å¾—éå¸¸ç®€å•ã€‚åªéœ€æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å³å¯åœ¨äº‘ç«¯è¿è¡Œä»£ç ï¼š

1. **åˆ›å»ºä¸€ä¸ª Modal åº”ç”¨**
2. **ä½¿ç”¨è£…é¥°å™¨ @app.function å°† Python å‡½æ•°åŒ…è£…æˆäº‘ç«¯ä»»åŠ¡**
3. Modal ä¼šå°†ä»£ç æ‰“åŒ…åˆ°å®¹å™¨ä¸­å¹¶åœ¨äº‘ç«¯è¿è¡Œ

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```python
import modal

# 1) åˆ›å»ºä¸€ä¸ª Modal åº”ç”¨
app = modal.App("example-get-started")

# 2) æ·»åŠ è£…é¥°å™¨ï¼Œåœ¨äº‘ç«¯è¿è¡Œæ­¤å‡½æ•°
@app.function()
def square(x=2):
    print(f"The square of {x} is {x**2}")  # è¿™æ®µä»£ç å°†åœ¨è¿œç¨‹å·¥ä½œèŠ‚ç‚¹ä¸Šè¿è¡Œï¼
```

è¿è¡Œå‡½æ•°

```shell
modal run get_started.py
```

è¿è¡Œåå°†çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š

```
âœ“ Initialized. View run at https://modal.com/apps/kaizhao/main/ap-qF7yK83DktpGusQUsJJ2HS
âœ“ Created objects.
â”œâ”€â”€ ğŸ”¨ Created mount ...
â””â”€â”€ ğŸ”¨ Created function square.
The square of 2 is 4
Stopping app - local entrypoint completed.
âœ“ App completed. View run at https://modal.com/apps/kaizhao/main/ap-qF7yK83DktpGusQUsJJ2HS
```

---

#### 2.2 å®šåˆ¶å®¹å™¨

å¦‚æœéœ€è¦åœ¨äº‘ç«¯å®¹å™¨ä¸­é¢„è£…ç‰¹å®šçš„ Python åº“ï¼ˆä¾‹å¦‚ NumPyï¼‰ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰è‡ªå®šä¹‰é•œåƒæ¥å®ç°ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š

1. **å®šä¹‰ä¸€ä¸ªåŸºäº Debian slim çš„ Modal Image å¹¶å®‰è£… NumPy**
2. **å°†é•œåƒé™„åŠ åˆ° Modal åº”ç”¨ä¸­**
3. **åœ¨å‡½æ•°ä¸­å¯¼å…¥å¹¶ä½¿ç”¨è¯¥åº“**

ç¤ºä¾‹ä»£ç ï¼š

```python
import modal

# 1) å®šä¹‰ä¸€ä¸ªåŒ…å« NumPy çš„ Modal é•œåƒ
image = modal.Image.debian_slim().pip_install("numpy")

# 2) å°†é•œåƒé™„åŠ åˆ°åº”ç”¨ä¸­
app = modal.App("example-custom-container", image=image)

@app.function()
def square(x=2):
    # 3) åœ¨å®¹å™¨ä¸­å¯¼å…¥å¹¶ä½¿ç”¨ NumPy åº“
    import numpy as np
    print(f"The square of {x} is {np.square(x)}")
```

è¿è¡Œæ•ˆæœä¸å‰ä¸€ä¸ªç¤ºä¾‹ç±»ä¼¼ï¼Œè¾“å‡ºä¸­ä¾æ—§ä¼šè®¡ç®—å‡ºæ•°å­—çš„å¹³æ–¹ã€‚

---

#### 2.3 æ°´å¹³æ‰©å±•

Modal æ”¯æŒç¬é—´æ‰©å±•åˆ°æ•°ç™¾ä¸ªå®¹å™¨ï¼Œä»¥å®ç°å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†ã€‚é€šè¿‡ `.map` æ–¹æ³•ï¼Œå¯ä»¥è½»æ¾å°†å‡½æ•°å¹¶è¡Œè¿è¡Œåœ¨ä¸€ç»„è¾“å…¥ä¸Šã€‚

æ­¥éª¤å¦‚ä¸‹ï¼š

1. **åˆ›å»ºä¸€ä¸ªæœ¬åœ°å…¥å£å‡½æ•°**ï¼ˆä½¿ç”¨è£…é¥°å™¨ `@app.local_entrypoint`ï¼‰
2. **ä½¿ç”¨ `.map` æ–¹æ³•å¯¹å‡½æ•°è¿›è¡Œå¹¶è¡Œè°ƒç”¨**

ç¤ºä¾‹ä»£ç ï¼š

```python
import modal

image = modal.Image.debian_slim().pip_install("numpy")
app = modal.App("example-scaling-out", image=image)

@app.function()
def square(x=2):
    import numpy as np
    print(f"The square of {x} is {np.square(x)}")

# 1) åˆ›å»ºæœ¬åœ°å…¥å£å‡½æ•°
@app.local_entrypoint()
def main():
    # 2) ä½¿ç”¨ `.map` æ–¹æ³•å¹¶è¡Œå¤„ç† 100 ä¸ªè¾“å…¥
    list(square.map(range(100)))
```

è¿è¡Œåï¼Œåº”ç”¨ä¼šå°† 100 ä¸ªä»»åŠ¡å¹¶è¡Œåˆ†å‘åˆ°å„ä¸ªå®¹å™¨ä¸­æ‰§è¡Œï¼Œå¹¶åœ¨ç»ˆç«¯æ˜¾ç¤ºæ¯ä¸ªè¾“å…¥å¯¹åº”çš„å¹³æ–¹å€¼ã€‚

---

#### 2.4 ä½¿ç”¨ GPU åŠ é€Ÿ

ä¸ºäº†è¿›ä¸€æ­¥åŠ é€Ÿè¿ç®—ä»»åŠ¡ï¼Œå¯ä»¥åˆ©ç”¨ GPUã€‚å¸¸è§çš„æ­¥éª¤åŒ…æ‹¬ï¼š

1. **ä½¿ç”¨å®˜æ–¹æ”¯æŒçš„ CUDA é•œåƒ**
2. **åœ¨é•œåƒä¸­å®‰è£… GPU åŠ é€Ÿæ‰€éœ€çš„ä¾èµ–åº“ï¼ˆå¦‚ cupyï¼Œä½œä¸º NumPy çš„ CUDA æ›¿ä»£å“ï¼‰**
3. **åœ¨å‡½æ•°ä¸­æŒ‡å®š GPU èµ„æºï¼Œä¾‹å¦‚ `gpu="A10G"`**

åœ¨å¼€å§‹ä¹‹å‰ å¯ä»¥ä¸åœ¨æœ¬åœ°ä½¿ç”¨ pip å®‰è£… cupyï¼š

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```python
import subprocess
import modal

# 1) ä½¿ç”¨å®˜æ–¹æ”¯æŒçš„ CUDA é•œåƒï¼Œå¹¶æ·»åŠ  Python 3.11
image = (
    modal.Image.from_registry("nvidia/cuda:12.4.0-devel-ubuntu22.04", add_python="3.11")
    # 2) å®‰è£… cupyï¼ˆä½œä¸º CUDA åŠ é€Ÿçš„ NumPy æ›¿ä»£å“ï¼‰
    .pip_install("cupy-cuda12x")
)

app = modal.App("example-gpu", image=image)

# 3) ä¸ºå‡½æ•°åˆ†é… GPU èµ„æºï¼ˆä¾‹å¦‚ A10Gï¼‰
@app.function(gpu="A10G")
def square(x=2):
    import cupy as cp
    # è°ƒç”¨ nvidia-smi æŸ¥çœ‹ GPU çŠ¶æ€
    subprocess.run(["nvidia-smi"])
    print(f"The square of {x} is {cp.square(x)}")
```

è¿è¡Œæ—¶ï¼Œå°†é¦–å…ˆæ˜¾ç¤º CUDA ç›¸å…³ä¿¡æ¯åŠ GPU çŠ¶æ€ï¼ˆä¾‹å¦‚ NVIDIA-SMI è¾“å‡ºï¼‰ï¼Œéšåè¾“å‡ºè®¡ç®—ç»“æœã€‚è¯·æ³¨æ„ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½ç”±äºé•œåƒæ„å»ºå’Œä¾èµ–å®‰è£…è¾ƒæ…¢ï¼Œè€Œåç»­è¿è¡Œåˆ™ä¼šæ›´å¿«ã€æ›´æµç•…ã€‚

---

## ä¸‰ GPU åŠ é€Ÿ

### 1. å®Œæ•´è¾“å‡ºä¿¡æ¯

åœ¨ GPU åŠ é€Ÿç¤ºä¾‹ä¸­ï¼Œå®Œæ•´çš„è¾“å‡ºæ—¥å¿—å¦‚ä¸‹ï¼ˆæ³¨æ„æ¯æ¬¡è¿è¡Œè¾“å‡ºå¯èƒ½ç•¥æœ‰ä¸åŒï¼Œä½†å¤§è‡´æµç¨‹ä¸€è‡´ï¼‰ï¼š

```
âœ“ Initialized. View run at https://modal.com/apps/kaizhao/main/ap-FDotngEg7iQ3rZeottuTyh
Building image im-4aHNFoxxG1mA87xYsEUUqb

=> Step 0: FROM nvidia/cuda:12.4.0-devel-ubuntu22.04
Getting image source signatures
Copying blob sha256:3bd5db8307cf789162a5a096889ea97023d5795068bdd8f07a0b09b3615d17df
Copying blob sha256:e06eb1b5c4cc0283389710e45402738c973f9c27a4cbdf90d53751723279e001
Copying blob sha256:6005190795580507557f886a8cb09d07f48a293591caa5f686ae89e2f363a350
Copying blob sha256:80150f70fb1e403d909539844a70fcb152ecfbd994a2c2c186dd71abb90be693
Copying blob sha256:7f308a7652768c0a964eb1720554421079b6a956110c7a12362380d2372fe82f
Copying blob sha256:3af11d09e9cd1eb9c379f0a4071231e5a5642eb728b4b33bcb76be291f3c9488
Copying blob sha256:edd1dba56169c724e9377dafe9d6dd34c0ef9585109fa8366b4a3ee68e07fd25
Copying blob sha256:0ae42424cadfa646dc06982b0ed3d08688b628c43fc379782b3b5d2d578eb041
Copying blob sha256:73b7968785dcb3e277c8de18c033614246b9419edb40941a0fc66aed6c831edb
Copying blob sha256:bccd10f490ab0f3fba61b193d1b80af91b17ca9bdca9768a16ed05ce16552fcb
Copying blob sha256:42896cdfd7b6a3e75be89e9fbc327a2dc8a1f56ab23a994553c28125ed85f528
Copying config sha256:d6b74566255fb8fb6e0ab61f2d2e7c3671b9f1233676ee374a104df2b43b2c04
Writing manifest to image destination
Unpacking OCI image
   â€¢ unpacking rootfs ...
   â€¢ ... done
   â€¢ unpacked image rootfs: /tmp/.tmpoEHILt
Copied image in 1.40s

=> Step 1: COPY /python/. /usr/local

=> Step 2: RUN ln -s /usr/local/bin/python3 /usr/local/bin/python

=> Step 3: ENV TERMINFO_DIRS=/etc/terminfo:/lib/terminfo:/usr/share/terminfo:/usr/lib/terminfo

=> Step 4: COPY /modal_requirements.txt /modal_requirements.txt

=> Step 5: RUN python -m pip install --upgrade pip wheel uv
Looking in indexes: http://pypi-mirror.modal.local:5555/simple
Requirement already satisfied: pip in /usr/local/lib/python3.11/site-packages (23.2.1)
Collecting pip
  Obtaining dependency information for pip from http://pypi-mirror.modal.local:5555/simple/pip/pip-25.0.1-py3-none-any.whl.metadata
  Downloading http://pypi-mirror.modal.local:5555/simple/pip/pip-25.0.1-py3-none-any.whl.metadata (3.7 kB)
Collecting wheel
  Obtaining dependency information for wheel from http://pypi-mirror.modal.local:5555/simple/wheel/wheel-0.45.1-py3-none-any.whl.metadata
  Downloading http://pypi-mirror.modal.local:5555/simple/wheel/wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
Collecting uv
  Obtaining dependency information for uv from http://pypi-mirror.modal.local:5555/simple/uv/uv-0.6.10-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata
  Downloading http://pypi-mirror.modal.local:5555/simple/uv/uv-0.6.10-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)
Downloading http://pypi-mirror.modal.local:5555/simple/pip/pip-25.0.1-py3-none-any.whl (1.8 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.8/1.8 MB 165.2 MB/s eta 0:00:00
Downloading http://pypi-mirror.modal.local:5555/simple/wheel/wheel-0.45.1-py3-none-any.whl (72 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 72.5/72.5 kB 313.1 MB/s eta 0:00:00
Downloading http://pypi-mirror.modal.local:5555/simple/uv/uv-0.6.10-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 16.6/16.6 MB 135.0 MB/s eta 0:00:00
Installing collected packages: wheel, uv, pip
  Attempting uninstall: pip
    Found existing installation: pip 23.2.1
    Uninstalling pip-23.2.1:
      Successfully uninstalled pip-23.2.1
Successfully installed pip-25.0.1 uv-0.6.10 wheel-0.45.1

=> Step 6: RUN uv pip install --system --compile-bytecode --no-cache --no-deps -r /modal_requirements.txt
Using Python 3.11.5 environment at: /usr/local
Resolved 15 packages in 184ms
Downloading aiohttp (1.2MiB)
   Building grpclib==0.4.7
 Downloaded aiohttp
      Built grpclib==0.4.7
Prepared 15 packages in 1.17s
Installed 15 packages in 24ms
Bytecode compiled 871 files in 456ms
 + aiohappyeyeballs==2.4.3
 + aiohttp==3.10.8
 + aiosignal==1.3.1
 + attrs==24.2.0
 + certifi==2024.8.30
 + frozenlist==1.4.1
 + grpclib==0.4.7
 + h2==4.1.0
 + hpack==4.0.0
 + hyperframe==6.0.1
 + idna==3.10
 + multidict==6.1.0
 + protobuf==5.29.4
 + typing-extensions==4.12.2
 + yarl==1.13.1

=> Step 7: RUN rm /modal_requirements.txt
Saving image...
Image saved, took 5.24s

Built image im-4aHNFoxxG1mA87xYsEUUqb in 129.31s

Building image im-QeSqRPPfuR6PNrYdomv273

=> Step 0: FROM base

=> Step 1: RUN python -m pip install cupy-cuda12x
Looking in indexes: http://pypi-mirror.modal.local:5555/simple
Collecting cupy-cuda12x
  Downloading http://pypi-mirror.modal.local:5555/simple/cupy-cuda12x/cupy_cuda12x-13.4.1-cp311-cp311-manylinux2014_x86_64.whl.metadata (2.6 kB)
Collecting numpy<2.3,>=1.22 (from cupy-cuda12x)
  Downloading http://pypi-mirror.modal.local:5555/simple/numpy/numpy-2.2.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)
Collecting fastrlock>=0.5 (from cupy-cuda12x)
  Downloading http://pypi-mirror.modal.local:5555/simple/fastrlock/fastrlock-0.8.3-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_28_x86_64.whl.metadata (7.7 kB)
Downloading http://pypi-mirror.modal.local:5555/simple/cupy-cuda12x/cupy_cuda12x-13.4.1-cp311-cp311-manylinux2014_x86_64.whl (105.4 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 105.4/105.4 MB 82.9 MB/s eta 0:00:00
Downloading http://pypi-mirror.modal.local:5555/simple/fastrlock/fastrlock-0.8.3-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_28_x86_64.whl (54 kB)
Downloading http://pypi-mirror.modal.local:5555/simple/numpy/numpy-2.2.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.4 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 16.4/16.4 MB 93.3 MB/s eta 0:00:00
Installing collected packages: fastrlock, numpy, cupy-cuda12x
Successfully installed cupy-cuda12x-13.4.1 fastrlock-0.8.3 numpy-2.2.4
Saving image...
Image saved, took 1.51s

Built image im-QeSqRPPfuR6PNrYdomv273 in 13.77s

âœ“ Created objects.
â”œâ”€â”€ ğŸ”¨ Created mount E:\code\java\project-litongjava\java-generative-manim\src\main\resources\modal\get_started.py
â””â”€â”€ ğŸ”¨ Created function square.

==========
== CUDA ==
==========

CUDA Version 12.4.0

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Sat Mar 29 19:38:57 2025
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A10G                    On  |   00000000:00:1E.0 Off |                    0 |
|  0%   35C    P8             17W /  300W |       1MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
The square of 2 is 4
Stopping app - local entrypoint completed.
âœ“ App completed. View run at https://modal.com/apps/kaizhao/main/ap-FDotngEg7iQ3rZeottuTyh
```

---

### 2.ä½¿ç”¨ Gpu åŠ é€Ÿçš„åŸç†ä»‹ç»

åœ¨æ„å»º GPU å®¹å™¨é•œåƒè¿‡ç¨‹ä¸­ï¼Œæ­¥éª¤ä¸º

```
FROM nvidia/cuda:12.4.0-devel-ubuntu22.04
COPY /python/. /usr/local
RUN ln -s /usr/local/bin/python3 /usr/local/bin/python
ENV TERMINFO_DIRS=/etc/terminfo:/lib/terminfo:/usr/share/terminfo:/usr/lib/terminfo
COPY /modal_requirements.txt /modal_requirements.txt
RUN python -m pip install --upgrade pip wheel uv
RUN uv pip install --system --compile-bytecode --no-cache --no-deps -r /modal_requirements.txt
RUN rm /modal_requirements.txt

FROM base
RUN python -m pip install cupy-cuda12x
```

ä¸‹é¢å¯¹æ•´ä¸ªå®¹å™¨é•œåƒæ„å»ºè¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥è¿›è¡Œè¯¦ç»†è¯´æ˜ï¼š

---

#### ç¬¬ä¸€é˜¶æ®µï¼šåŸºäº CUDA å¼€å‘é•œåƒæ„å»ºåŸºç¡€ç¯å¢ƒ

1. **`FROM nvidia/cuda:12.4.0-devel-ubuntu22.04`**

   - **ä½œç”¨**ï¼šä½¿ç”¨ NVIDIA å®˜æ–¹æä¾›çš„ CUDA å¼€å‘ç‰ˆé•œåƒä½œä¸ºåŸºç¡€ç¯å¢ƒã€‚
   - **ç›®çš„**ï¼šè¯¥é•œåƒå†…é¢„è£…äº† CUDA å·¥å…·é“¾å’Œç›¸åº”çš„é©±åŠ¨æ”¯æŒï¼Œä½¿å¾—åç»­å¯ä»¥ç›´æ¥è¿›è¡Œ GPU ç¼–ç¨‹ã€è°ƒè¯•å’ŒåŠ é€Ÿã€‚
   - **æœºåˆ¶**ï¼šè¿™æ˜¯ Dockerfile ä¸­çš„åŸºç¡€é•œåƒå£°æ˜ï¼Œæ‰€æœ‰åç»­æŒ‡ä»¤éƒ½åŸºäºè¿™ä¸ªé•œåƒè¿›è¡Œæ„å»ºã€‚

2. **`COPY /python/. /usr/local`**

   - **ä½œç”¨**ï¼šå°†æœ¬åœ°ç›®å½• `/python/` ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…çš„ `/usr/local` ç›®å½•ã€‚
   - **ç›®çš„**ï¼šç¡®ä¿æœ¬åœ°é…ç½®çš„ Python ç¯å¢ƒæ–‡ä»¶æˆ–å·¥å…·èƒ½å¤Ÿè¢«å®¹å™¨ä½¿ç”¨ï¼Œä»è€Œæä¾›å®Œå–„çš„ Python è¿è¡Œç¯å¢ƒã€‚
   - **æœºåˆ¶**ï¼šç±»ä¼¼äº Docker çš„ `COPY` å‘½ä»¤ï¼Œå°†æ„å»ºä¸Šä¸‹æ–‡ä¸­çš„æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒå†…æŒ‡å®šä½ç½®ã€‚

3. **`RUN ln -s /usr/local/bin/python3 /usr/local/bin/python`**

   - **ä½œç”¨**ï¼šåœ¨å®¹å™¨å†…å»ºç«‹ä¸€ä¸ªè½¯é“¾æ¥ï¼Œä½¿å¾— `python` å‘½ä»¤æŒ‡å‘ `python3`ã€‚
   - **ç›®çš„**ï¼šæ–¹ä¾¿è°ƒç”¨ï¼Œé¿å…å› ç³»ç»Ÿä¸­é»˜è®¤æŒ‡å‘ Python 2 æˆ–æœªå®šä¹‰è€Œäº§ç”Ÿå…¼å®¹æ€§é—®é¢˜ï¼Œç¡®ä¿æ‰€æœ‰ Python å‘½ä»¤è°ƒç”¨çš„æ˜¯ Python3ã€‚
   - **æœºåˆ¶**ï¼šé€šè¿‡åˆ›å»ºç¬¦å·é“¾æ¥å®ç°å‘½ä»¤åˆ«åï¼Œç®€åŒ–åç»­è„šæœ¬å’Œåº”ç”¨çš„è°ƒç”¨æ–¹å¼ã€‚

4. **`ENV TERMINFO_DIRS=/etc/terminfo:/lib/terminfo:/usr/share/terminfo:/usr/lib/terminfo`**

   - **ä½œç”¨**ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ `TERMINFO_DIRS`ã€‚
   - **ç›®çš„**ï¼šæŒ‡å®šå®¹å™¨å†…æŸ¥æ‰¾ç»ˆç«¯ä¿¡æ¯ï¼ˆterminfoï¼‰æ•°æ®åº“çš„è·¯å¾„ï¼Œç¡®ä¿åœ¨ä¸åŒç»ˆç«¯ç¯å¢ƒä¸‹è¾“å‡ºå’Œäº¤äº’ä¿¡æ¯èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚
   - **æœºåˆ¶**ï¼šåˆ©ç”¨ Docker çš„ `ENV` æŒ‡ä»¤ï¼Œå°†å˜é‡æ³¨å…¥åˆ°å®¹å™¨ç¯å¢ƒä¸­ï¼Œä½¿å¾—æ‰€æœ‰è¿è¡Œçš„ç¨‹åºéƒ½èƒ½è®¿é—®å¹¶ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚

5. **`COPY /modal_requirements.txt /modal_requirements.txt`**

   - **ä½œç”¨**ï¼šå°†æœ¬åœ°çš„ `modal_requirements.txt` æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨æ ¹ç›®å½•ä¸‹ã€‚
   - **ç›®çš„**ï¼šè¯¥æ–‡ä»¶è®°å½•äº†åº”ç”¨æ‰€éœ€è¦çš„æ‰€æœ‰ Python åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œé€šè¿‡å¤åˆ¶è¿›å®¹å™¨åä¾¿äºç»Ÿä¸€å®‰è£…ä¾èµ–ï¼Œä»è€Œå®ç°ä¾èµ–ç‰ˆæœ¬é”å®šå’Œç¯å¢ƒçš„ä¸€è‡´æ€§ã€‚
   - **æœºåˆ¶**ï¼šç±»ä¼¼å‰é¢çš„ `COPY` æŒ‡ä»¤ï¼Œå°†æœ¬åœ°æ–‡ä»¶çº³å…¥é•œåƒæ„å»ºä¸Šä¸‹æ–‡ï¼Œä¾›åç»­æ­¥éª¤ä½¿ç”¨ã€‚

6. **`RUN python -m pip install --upgrade pip wheel uv`**

   - **ä½œç”¨**ï¼šå‡çº§ pipï¼Œå¹¶å®‰è£… `wheel` å’Œ `uv` å·¥å…·ã€‚
   - **ç›®çš„**ï¼š
     - å‡çº§ pip ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„åŒ…ç®¡ç†å™¨ï¼Œè·å¾—æ›´å¥½çš„æ€§èƒ½å’Œå®‰å…¨æ€§ï¼›
     - å®‰è£… `wheel` æœ‰åŠ©äºæ„å»ºå’Œå®‰è£… Python åŒ…ï¼›
     - `uv` æ˜¯ä¸€ç§åŠ é€Ÿ pip å®‰è£…è¿‡ç¨‹çš„å·¥å…·ã€‚
   - **æœºåˆ¶**ï¼šä½¿ç”¨ Python çš„æ¨¡å—è°ƒç”¨æ–¹å¼æ¥è¿è¡Œ pip å‘½ä»¤ï¼Œå¯¹åŸºç¡€ Python ç¯å¢ƒè¿›è¡Œæ›´æ–°å’Œæ‰©å±•ã€‚

7. **`RUN uv pip install --system --compile-bytecode --no-cache --no-deps -r /modal_requirements.txt`**

   - **ä½œç”¨**ï¼šåˆ©ç”¨ `uv pip` æ ¹æ® `modal_requirements.txt` ä¸­çš„å†…å®¹å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…ã€‚
   - **ç›®çš„**ï¼š
     - ç»Ÿä¸€å®‰è£…æ‰€æœ‰ä¾èµ–ï¼Œç¡®ä¿è¿œç¨‹ç¯å¢ƒä¸æœ¬åœ°ç¯å¢ƒä¸€è‡´ï¼›
     - åŒæ—¶ç¼–è¯‘å­—èŠ‚ç ï¼Œæé«˜åç»­è¿è¡Œé€Ÿåº¦ï¼›
     - ç¦ç”¨ç¼“å­˜å’Œä¾èµ–æ£€æŸ¥ï¼Œä»¥é¿å…ä¸å¿…è¦çš„å®‰è£…æˆ–ç‰ˆæœ¬å†²çªã€‚
   - **æœºåˆ¶**ï¼šè¯¥å‘½ä»¤é€šè¿‡è¯»å–ä¾èµ–æ–‡ä»¶ï¼Œåœ¨å®¹å™¨ä¸­å®‰è£…æŒ‡å®šçš„åŒ…ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„å­—èŠ‚ç ï¼Œç¡®ä¿ç¯å¢ƒæ„å»ºå®Œæˆåæ— éœ€åœ¨è¿è¡Œæ—¶é‡æ–°å®‰è£…ä¾èµ–ã€‚

8. **`RUN rm /modal_requirements.txt`**
   - **ä½œç”¨**ï¼šåˆ é™¤å®¹å™¨å†…çš„ `modal_requirements.txt` æ–‡ä»¶ã€‚
   - **ç›®çš„**ï¼šå‡å°‘é•œåƒä½“ç§¯ï¼Œé˜²æ­¢æ³„éœ²ä¾èµ–åˆ—è¡¨ï¼ˆå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œä¿æŒé•œåƒæ•´æ´ã€‚
   - **æœºåˆ¶**ï¼šç®€å•çš„æ–‡ä»¶åˆ é™¤æ“ä½œï¼Œæ¸…é™¤æ„å»ºè¿‡ç¨‹ä¸­ä¸´æ—¶ä½¿ç”¨çš„æ–‡ä»¶ã€‚

---

#### ç¬¬äºŒé˜¶æ®µï¼šåŸºäºç²¾ç®€åŸºç¡€é•œåƒå®‰è£… GPU åŠ é€Ÿåº“

9. **`FROM base`**

   - **ä½œç”¨**ï¼šä½¿ç”¨åä¸º `base` çš„é•œåƒä½œä¸ºæ–°çš„æ„å»ºåŸºç¡€ã€‚
   - **ç›®çš„**ï¼šåœ¨å®Œæˆåˆæ­¥ä¾èµ–å®‰è£…åï¼Œåˆ‡æ¢åˆ°ä¸€ä¸ªæ›´ç²¾ç®€çš„é•œåƒï¼Œé€šå¸¸ç”¨äºæ„å»ºæœ€ç»ˆçš„ç”Ÿäº§ç¯å¢ƒé•œåƒã€‚
   - **æœºåˆ¶**ï¼šDocker çš„å¤šé˜¶æ®µæ„å»ºï¼Œé€šè¿‡å¤šä¸ª `FROM` æŒ‡ä»¤æ„å»ºå‡ºä¸€ä¸ªè¾ƒå°ä¸”ä»…åŒ…å«å¿…è¦è¿è¡Œç¯å¢ƒçš„æœ€ç»ˆé•œåƒã€‚

10. **`RUN python -m pip install cupy-cuda12x`**
    - **ä½œç”¨**ï¼šåœ¨æœ€ç»ˆé•œåƒä¸­ä½¿ç”¨ pip å®‰è£… `cupy-cuda12x` åŒ…ã€‚
    - **ç›®çš„**ï¼š
      - `cupy-cuda12x` æ˜¯åŸºäº CUDA çš„åŠ é€Ÿåº“ï¼Œæ—¨åœ¨æ›¿ä»£ NumPy åœ¨ GPU ä¸Šçš„è¿ç®—ï¼Œä»è€Œæ˜¾è‘—æå‡è®¡ç®—æ€§èƒ½ã€‚
      - é€šè¿‡é¢„è£…è¯¥åŒ…ï¼Œå¯ä»¥ç¡®ä¿åœ¨è¿œç¨‹è¿è¡Œæ—¶æ— éœ€å†æ¬¡è¿›è¡Œå®‰è£…ï¼ŒåŠ é€Ÿå¯åŠ¨è¿‡ç¨‹ã€‚
    - **æœºåˆ¶**ï¼šåˆ©ç”¨ pip å‘½ä»¤åœ¨æœ€ç»ˆç¯å¢ƒä¸­å®‰è£…ç‰¹å®šçš„ GPU åŠ é€Ÿåº“ï¼Œè¿™ä¸€æ­¥é€šå¸¸åœ¨é•œåƒæ„å»ºè¿‡ç¨‹ä¸­å®Œæˆï¼Œè€Œéåœ¨å®¹å™¨å¯åŠ¨åå†åŠ¨æ€å®‰è£…ã€‚

---

é€šè¿‡ä»¥ä¸Šå„æ­¥éª¤ï¼Œæ•´ä¸ª GPU å®¹å™¨é•œåƒæ„å»ºè¿‡ç¨‹å®ç°äº†ä»¥ä¸‹ç›®æ ‡ï¼š

- **ä¾èµ–å›ºå®šå’Œç¯å¢ƒä¸€è‡´æ€§**ï¼šå°†æ‰€æœ‰å¿…è¦çš„ Python åŒ…å’Œå·¥å…·åœ¨é•œåƒæ„å»ºæ—¶é¢„å…ˆå®‰è£…å¥½ï¼Œç¡®ä¿æ— è®ºåœ¨æœ¬åœ°è¿˜æ˜¯è¿œç¨‹è¿è¡Œï¼Œéƒ½èƒ½è·å¾—ä¸€è‡´çš„ç¯å¢ƒã€‚
- **é«˜æ€§èƒ½ GPU æ”¯æŒ**ï¼šä½¿ç”¨ NVIDIA CUDA é•œåƒå’Œå®‰è£… cupy-cuda12xï¼Œä½¿å¾—å®¹å™¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ GPU è¿›è¡ŒåŠ é€Ÿè¿ç®—ã€‚
- **é•œåƒç²¾ç®€ä¸å®‰å…¨**ï¼šåˆ©ç”¨å¤šé˜¶æ®µæ„å»ºå’Œåˆ é™¤ä¸å¿…è¦çš„æ–‡ä»¶ï¼Œå‡å°‘æœ€ç»ˆé•œåƒä½“ç§¯ï¼ŒåŒæ—¶é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è¿™æ ·çš„æ„å»ºæµç¨‹æ—¢ä¿è¯äº†ç¯å¢ƒçš„ç¨³å®šæ€§ä¸é«˜æ•ˆæ€§ï¼Œåˆæ–¹ä¾¿åç»­çš„éƒ¨ç½²ä¸æ‰©å±•ã€‚

---

### 3. è¿œç¨‹ç¯å¢ƒä¸‹ å®‰è£…åŸç†

åœ¨ Modal çš„è¿œç¨‹å®¹å™¨ç¯å¢ƒä¸­ï¼Œæ‰€æœ‰ä¾èµ–åŒ…ï¼ˆåŒ…æ‹¬ cupyï¼‰åº”å½“åœ¨æ„å»ºé•œåƒæ—¶æå‰å®‰è£…ã€‚å¦‚æœä½ ä»…åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ `pip install cupy`ï¼Œé‚£ä¹ˆç”±äºè¿œç¨‹è¿è¡Œæ—¶å®¹å™¨å·²ç»æ„å»ºå¥½å¹¶ç¼“å­˜ï¼Œè¿è¡Œæ—¶ä¸ä¼šå†å»å®‰è£… cupyã€‚

---

### 4. æŒ‡å®š token

Modal æ¨èä¸è¦åœ¨ä»£ç ä¸­ç›´æ¥ç¡¬ç¼–ç æˆ–è®¾ç½® tokenï¼Œå› ä¸ºè¿™ä¼šå¸¦æ¥å®‰å…¨éšæ‚£ã€‚æœ€ä½³åšæ³•æ˜¯é€šè¿‡ CLI å‘½ä»¤ï¼ˆå¦‚ `modal token set --token-id id --token-secret secret`ï¼‰æˆ–å°† token é…ç½®ä¸ºç¯å¢ƒå˜é‡ï¼ˆä¾‹å¦‚ `MODAL_API_KEY`ï¼‰ï¼Œç”± Modal å®¢æˆ·ç«¯åœ¨è¿è¡Œæ—¶è‡ªåŠ¨åŠ è½½è¿™äº›å‡­æ®ã€‚å¦‚æœä½ ç¡®å®éœ€è¦åœ¨ä»£ç ä¸­ä½¿ç”¨ tokenï¼Œå»ºè®®å°†å®ƒå­˜å‚¨åœ¨å®‰å…¨çš„é…ç½®æ–‡ä»¶æˆ–ç§˜å¯†ç®¡ç†ç³»ç»Ÿä¸­ï¼Œç„¶åè¯»å–åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œä½†ç›´æ¥ç¡¬ç¼–ç åˆ°ä»£ç ä¸­æ˜¯ä¸è¢«æ¨èçš„ã€‚

cat /root/.modal.toml
ç¬”è€…çš„é€‰æ‹©æ˜¯ç»´æŠ¤é…ç½®æ–‡ä»¶

```toml
[kaizhao]
token_id = "ak-NXw"
token_secret = "as-moKQN8"
active = true

```

### 4. å¦‚ä½•åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¯»å–å¹¶è¿è¡Œæœ¬åœ°è„šæœ¬æ–‡ä»¶

è¦åœ¨ Modal çš„è¿œç¨‹ç¯å¢ƒä¸­è¿è¡Œæœ¬åœ°è„šæœ¬æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

1. **æŒ‚è½½æœ¬åœ°ç›®å½•**  
   åˆ©ç”¨ Modal çš„æŒ‚è½½åŠŸèƒ½ï¼Œå°†æœ¬åœ°è„šæœ¬æ‰€åœ¨ç›®å½•æŒ‚è½½åˆ°è¿œç¨‹å®¹å™¨ã€‚ä¾‹å¦‚ï¼š

model_run_with_script.py

```python
import modal

# å°†æœ¬åœ°è„šæœ¬ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„ /scripts ç›®å½•
local_scripts = modal.Mount.from_local_dir("scripts")
image = modal.Image.debian_slim().pip_install("numpy")

app = modal.App("example-run-local-script", image=image, mounts=[local_scripts])

@app.function()
def run_script():
    # ä¾‹å¦‚è¯»å–å¹¶æ‰§è¡Œ /scripts/test.py è„šæœ¬
    with open("/scripts/numpy_square.py", "r", encoding="utf-8") as f:
        script_content = f.read()
    exec(script_content)
```

modal.Mount usage will soon be deprecated.
Use image.add_local_dir instead, which is functionally and performance-wise equivalent.

åˆ‡æ¢ä¸ºä½¿ç”¨ add_local_dir

```python
import modal

# åˆ›å»ºé•œåƒï¼Œå¹¶å°†æœ¬åœ° "scripts" ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„ /scripts ç›®å½•
image = modal.Image.debian_slim().pip_install("numpy").add_local_dir("scripts", "/scripts")

# åˆ›å»º Modal åº”ç”¨ï¼Œå¹¶æŒ‡å®šä½¿ç”¨æ›´æ–°åçš„é•œåƒ
app = modal.App("example-run-local-script", image=image)

@app.function()
def run_script():
    # ä¾‹å¦‚è¯»å–å¹¶æ‰§è¡Œ /scripts/numpy_square.py è„šæœ¬
    with open("/scripts/numpy_square.py", "r", encoding="utf-8") as f:
        script_content = f.read()
    exec(script_content)

```

2. **å°†è„šæœ¬æ‰“åŒ…è¿›å®¹å™¨é•œåƒ**  
   å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨æ„å»ºé•œåƒæ—¶å°†æœ¬åœ°è„šæœ¬æ–‡ä»¶åŒ…å«è¿›å»ã€‚å¯ä»¥åœ¨ `modal.Image` æ„å»ºè¿‡ç¨‹ä¸­æŒ‡å®šä¸Šä¸‹æ–‡ç›®å½•ï¼Œè¿™æ ·æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«æ‰“åŒ…åˆ°é•œåƒä¸­ï¼Œç„¶ååœ¨è¿œç¨‹ç¯å¢ƒä¸­ç›´æ¥è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š

   ```python
   image = modal.Image.debian_slim().pip_install("numpy")
   # å‡è®¾æœ¬åœ°ç›®å½• "my_scripts" åŒ…å«éœ€è¦è¿è¡Œçš„è„šæœ¬
   # å¯å°†è¯¥ç›®å½•ä½œä¸ºæŒ‚è½½ç›®å½•æˆ–ç›´æ¥æ„å»ºé•œåƒæ—¶åŒ…å«è¯¥ç›®å½•
   app = modal.App("example-embed-script", image=image, mounts=[modal.Mount.from_local_dir("my_scripts")])

   @app.function()
   def run_script():
       exec(open("my_scripts/test.py", "r", encoding="utf-8").read())
   ```

è¿™ç§æ–¹å¼èƒ½å¤Ÿç¡®ä¿åœ¨è¿œç¨‹å®¹å™¨ä¸­é¡ºåˆ©è¯»å–åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œå¹¶æŒ‰éœ€æ‰§è¡Œè„šæœ¬å†…å®¹ã€‚

---

## å››ã€æ€»ç»“

æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•å€ŸåŠ© Modal.com çš„äº‘ç«¯ GPU æœåŠ¡æ¥åŠ é€Ÿ Python æ¸²æŸ“ä»»åŠ¡ã€‚é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å®Œæˆä»ç¯å¢ƒé…ç½®ã€å‡½æ•°éƒ¨ç½²ã€å®¹å™¨å®šåˆ¶ã€æ°´å¹³æ‰©å±•åˆ° GPU åŠ é€Ÿè¿è¡Œçš„å…¨è¿‡ç¨‹ï¼š

- **ç¯å¢ƒæ­å»ºä¸ç™»å½•**ï¼šä½¿ç”¨ Modal CLI å¿«é€Ÿç™»å½•å¹¶åˆå§‹åŒ–åº”ç”¨ã€‚
- **ç®€å•å‡½æ•°éƒ¨ç½²**ï¼šå°†æœ¬åœ°ä»£ç é€šè¿‡è£…é¥°å™¨åŒ…è£…ä¸ºäº‘ç«¯ä»»åŠ¡ï¼Œå¹¶éªŒè¯è¾“å‡ºã€‚
- **å®šåˆ¶é•œåƒ**ï¼šæ ¹æ®éœ€è¦é¢„è£…ç‰¹å®šä¾èµ–ï¼ˆå¦‚ NumPy æˆ– cupyï¼‰ã€‚
- **å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†**ï¼šåˆ©ç”¨ `.map` æ–¹æ³•å®ç°ä»»åŠ¡çš„æ°´å¹³æ‰©å±•ã€‚
- **GPU åŠ é€Ÿ**ï¼šç»“åˆå®˜æ–¹ CUDA é•œåƒå’Œ GPU èµ„æºï¼Œå®ç°æ›´é«˜æ•ˆçš„æ¸²æŸ“è¿ç®—ã€‚

é€šè¿‡ Modal.com å¼ºå¤§çš„ GPU åŠ é€Ÿèƒ½åŠ›ï¼Œç”¨æˆ·å¯ä»¥æ˜¾è‘—æå‡æ¸²æŸ“ä¸è®¡ç®—ä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡ï¼Œå°¤å…¶é€‚ç”¨äº AI è®­ç»ƒã€è§†é¢‘å¤„ç†å’Œé«˜æ€§èƒ½å›¾å½¢æ¸²æŸ“ç­‰åœºæ™¯ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½ç¨æ…¢ï¼Œä½†éšç€ç¼“å­˜å’Œé•œåƒæ„å»ºçš„å®Œæˆï¼Œåç»­è¿è¡Œå°†ä¼šæ›´åŠ è¿…æ·é«˜æ•ˆã€‚

---

è¿™å°±æ˜¯åˆ©ç”¨ Modal.com è¿›è¡Œ Python GPU åŠ é€Ÿæ¸²æŸ“çš„å®Œæ•´æµç¨‹ã€‚å¸Œæœ›è¿™ç¯‡æ–‡æ¡£å¯¹ä½ åœ¨å®é™…é¡¹ç›®ä¸­çš„éƒ¨ç½²å’Œä¼˜åŒ–æœ‰æ‰€å¸®åŠ©ã€‚
