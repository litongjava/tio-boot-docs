# Tio-Boot æ•´åˆ Java-DB ä¸ Enjoy æ¨¡æ¿å¼•æ“ç¤ºä¾‹

[[toc]]

æœ¬æ•™ç¨‹å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ **Tio-Boot** æ¡†æ¶ï¼Œç»“åˆ **Java-DBï¼ˆActiveRecordï¼‰** å’Œ **Enjoy æ¨¡æ¿å¼•æ“**ï¼Œå¿«é€Ÿæ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„ Web åº”ç”¨â€”â€”â€œStudy11 å­¦ä¹ å¹³å°â€ã€‚æˆ‘ä»¬å°†ä»æ•°æ®åº“è®¾è®¡ã€åç«¯æœåŠ¡ã€æ¨¡æ¿æ¸²æŸ“åˆ°å‰ç«¯å±•ç¤ºï¼Œå®Œæ•´æ¼”ç¤ºæ•°æ®é©±åŠ¨é¡µé¢çš„å®ç°è¿‡ç¨‹ã€‚

---

## ğŸ¯ é¡¹ç›®ç›®æ ‡

åˆ›å»ºä¸€ä¸ªåä¸º `Study11 Learning Platform` çš„ç½‘ç«™ï¼Œç”¨äºå±•ç¤ºæ•°å­¦/ç§‘å­¦çŸ¥è¯†ç‚¹åŠ¨ç”»æ•™ç¨‹ã€‚è¯¥å¹³å°å…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š

- æ•°æ®åº“å­˜å‚¨å­¦ä¹ å†…å®¹ï¼ˆä¸»é¢˜ã€è¯­è¨€ã€æµè§ˆé‡ç­‰ï¼‰
- åç«¯é€šè¿‡ Tio-Boot å¤„ç†è¯·æ±‚
- ä½¿ç”¨ Enjoy æ¨¡æ¿å¼•æ“åŠ¨æ€ç”Ÿæˆ HTML é¡µé¢
- å‰ç«¯é‡‡ç”¨å“åº”å¼è®¾è®¡ï¼Œç¾è§‚æ˜“ç”¨

æœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![Study11 Learning Platform](images/01.png)

---

## ğŸ§± æŠ€æœ¯æ ˆæ¦‚è§ˆ

| ç»„ä»¶ | ç‰ˆæœ¬/è¯´æ˜ |
|------|---------|
| **Tio-Boot** | é«˜æ€§èƒ½è½»é‡çº§ Web æ¡†æ¶ï¼ŒåŸºäº TIO ç½‘ç»œåº“ |
| **Java-DB** | Tio Boot æä¾›çš„ ORM å·¥å…·ï¼Œç®€åŒ–æ•°æ®åº“æ“ä½œ |
| **Enjoy æ¨¡æ¿å¼•æ“** | æ”¯æŒä¸­æ–‡è¡¨è¾¾å¼çš„é«˜æ€§èƒ½æ¨¡æ¿å¼•æ“ |
| **PostgreSQL / MySQL** | ç¤ºä¾‹ä½¿ç”¨ PostgreSQL æ•°æ®åº“ |

---

## ğŸ”§ ç¬¬ä¸€æ­¥ï¼šæ•°æ®åº“è®¾è®¡

æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€å¼ è¡¨æ¥ä¿å­˜å­¦ä¹ èµ„æºä¿¡æ¯ã€‚

```sql
DROP TABLE IF EXISTS study11_html_code;

CREATE TABLE study11_html_code (
  id BIGINT PRIMARY KEY,
  topic VARCHAR(255) NOT NULL,
  "language" VARCHAR(50),
  view_count INT DEFAULT 0,
  "create_time" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

> âœ… æ³¨æ„ï¼š
> - `id` ä¸ºä¸»é”®ï¼Œå»ºè®®ä½¿ç”¨è‡ªå¢æˆ–åºåˆ—ç”Ÿæˆã€‚
> - `"language"` å­—æ®µä½¿ç”¨åŒå¼•å·ä»¥æ”¯æŒä¿ç•™å­—ã€‚
> - `view_count` è®°å½•æµè§ˆæ¬¡æ•°ï¼Œåˆå§‹ä¸º 0ã€‚
> - `create_time` è‡ªåŠ¨è®°å½•åˆ›å»ºæ—¶é—´ã€‚

---

## ğŸ“ ç¬¬äºŒæ­¥ï¼šé¡¹ç›®ç»“æ„

```
src/main/java/com/litongjava/study11/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ StudyEnjoyEngineConfig.java
â”œâ”€â”€ handler/
â”‚   â””â”€â”€ IndexHandler.java
â”œâ”€â”€ service/
â”‚   â””â”€â”€ IndexService.java
â””â”€â”€ resources/enjoy-templates/
    â””â”€â”€ index.html
```

---

## âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šé…ç½® Enjoy æ¨¡æ¿å¼•æ“

åœ¨ `StudyEnjoyEngineConfig.java` ä¸­åˆå§‹åŒ–æ¨¡æ¿å¼•æ“é…ç½®ï¼š

```java
package com.litongjava.study11.config;

import com.jfinal.template.Engine;
import com.litongjava.template.RowFieldGetter;

public class StudyEnjoyEngineConfig {

  private final String RESOURCE_BASE_PATH = "/enjoy-templates/";

  public void config() {
    Engine engine = Engine.use();
    engine.setBaseTemplatePath(RESOURCE_BASE_PATH);
    engine.setToClassPathSourceFactory(); // ä½¿ç”¨ç±»è·¯å¾„åŠ è½½æ¨¡æ¿æ–‡ä»¶
    engine.setDevMode(true);              // å¼€å‘æ¨¡å¼ï¼Œæ”¯æŒçƒ­åŠ è½½
    Engine.setFastMode(true);             // å¯ç”¨æé€Ÿæ¨¡å¼ï¼Œæå‡æ€§èƒ½
    Engine.setChineseExpression(true);    // æ”¯æŒä¸­æ–‡å˜é‡åå’Œè¡¨è¾¾å¼

    // æ·»åŠ  Row å¯¹è±¡å­—æ®µè·å–å™¨ï¼Œæ–¹ä¾¿æ¨¡æ¿ä¸­è®¿é—® Row æ•°æ®
    Engine.addFieldGetterToFirst(new RowFieldGetter());
  }
}
```

> ğŸ’¡ å°è´´å£«ï¼š
> - `setToClassPathSourceFactory()` è¡¨ç¤ºæ¨¡æ¿æ–‡ä»¶ä½äº `classpath:/enjoy-templates/`
> - `RowFieldGetter` å…è®¸ä½ åœ¨æ¨¡æ¿ä¸­ç›´æ¥è®¿é—® `item.topic` è€Œé `item.get("topic")`

---

## ğŸ”„ ç¬¬å››æ­¥ï¼šç¼–å†™æ§åˆ¶å™¨ï¼ˆHandlerï¼‰

`IndexHandler.java` æ¥æ”¶ HTTP è¯·æ±‚å¹¶è¿”å›æ¸²æŸ“åçš„é¡µé¢ã€‚

```java
package com.litongjava.study11.handler;

import com.litongjava.jfinal.aop.Aop;
import com.litongjava.study11.service.IndexService;
import com.litongjava.tio.boot.http.TioRequestContext;
import com.litongjava.tio.http.common.HttpRequest;
import com.litongjava.tio.http.common.HttpResponse;
import com.litongjava.tio.http.server.util.Resps;

public class IndexHandler {

  public HttpResponse index(HttpRequest request) {
    HttpResponse response = TioRequestContext.getResponse();
    IndexService indexService = Aop.get(IndexService.class);
    String html = indexService.index();
    Resps.html(response, html);
    return response;
  }
}
```

> âœ… åŠŸèƒ½è¯´æ˜ï¼š
> - ä½¿ç”¨ `Aop.get()` è·å– `IndexService` å®ä¾‹
> - è°ƒç”¨ `index()` æ–¹æ³•è·å– HTML å†…å®¹
> - é€šè¿‡ `Resps.html()` è¿”å›å“åº”

---

## ğŸ—ƒï¸ ç¬¬äº”æ­¥ï¼šæ•°æ®æŸ¥è¯¢ä¸æ¨¡æ¿æ¸²æŸ“

`IndexService.java` è´Ÿè´£ä»æ•°æ®åº“è¯»å–æ•°æ®ï¼Œå¹¶è°ƒç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“ã€‚

```java
package com.litongjava.study11.service;

import java.util.List;

import com.jfinal.kit.Kv;
import com.litongjava.db.activerecord.Db;
import com.litongjava.db.activerecord.Row;
import com.litongjava.template.EnjoyTemplate;

public class IndexService {

  public String index() {
    List<Row> data = Db.find("SELECT id, topic, language, view_count, create_time " +
                             "FROM study11_html_code ORDER BY id");
    
    Kv kv = Kv.by("data", data);
    return EnjoyTemplate.renderToString("index.html", kv);
  }
}
```

> ğŸ” è§£æï¼š
> - ä½¿ç”¨ `Db.find()` æŸ¥è¯¢æ‰€æœ‰è®°å½•
> - å°†ç»“æœå°è£…è¿› `Kv` å¯¹è±¡ä¼ ç»™æ¨¡æ¿
> - è°ƒç”¨ `EnjoyTemplate.renderToString()` æ¸²æŸ“ HTML

---

## ğŸ–¼ï¸ ç¬¬å…­æ­¥ï¼šHTML æ¨¡æ¿è®¾è®¡

åˆ›å»º `src/main/resources/enjoy-templates/index.html` æ–‡ä»¶ï¼š

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Study11 Learning Platform</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px;
    }

    .header h1 {
      color: white;
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      color: rgba(255,255,255,0.9);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      padding: 20px 0;
    }

    .card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,0,0,0.25);
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }

    .card-title {
      font-size: 1.4rem;
      color: #333;
      margin-bottom: 15px;
      line-height: 1.4;
      transition: color 0.3s ease;
    }

    .card:hover .card-title {
      color: #667eea;
    }

    .card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #eee;
    }

    .card-language {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
    }

    .card-views {
      color: #666;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .card-time {
      color: #999;
      font-size: 0.85rem;
      margin-top: 8px;
      font-style: italic;
    }

    .empty-state {
      text-align: center;
      color: white;
      padding: 60px 20px;
      grid-column: 1 / -1;
    }

    .empty-state h2 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    @media (max-width: 768px) {
      .content-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .card {
        padding: 20px;
      }
    }

    .view-icon {
      width: 16px;
      height: 16px;
      display: inline-block;
      vertical-align: middle;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Study11 Learning Platform</h1>
      <p>Explaining knowledge through animations</p>
    </div>

    <div class="content-grid">
      #if(data && data.size() > 0)
        #for(item : data)
          <div class="card" onclick="window.location.href='/preview/#(item.id)'">
            <h3 class="card-title">#(item.topic)</h3>
            <div class="card-time">Created: #date(item.create_time, "yyyy-MM-dd HH:mm:ss")</div>
            <div class="card-meta">
              <span class="card-language">#(item.language??"Unknown")</span>
              <span class="card-views">
                <svg class="view-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                </svg>
                #(item.view_count??0) views
              </span>
            </div>
          </div>
        #end
      #else
        <div class="empty-state">
          <h2>No Data Available</h2>
          <p>There is no learning content yet. Please check back later.</p>
        </div>
      #end
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('.card');
      cards.forEach(card => {
        card.addEventListener('mouseenter', () => card.style.transform = 'translateY(-5px)');
        card.addEventListener('mouseleave', () => card.style.transform = 'translateY(0)');
      });
    });
  </script>
</body>
</html>
```

> âœ… æ¨¡æ¿ç‰¹æ€§ï¼š
> - ä½¿ç”¨ `#if`, `#for` æ§åˆ¶æµç¨‹
> - `#date(...)` æ ¼å¼åŒ–æ—¶é—´
> - `??` é˜²æ­¢ç©ºå€¼å¼‚å¸¸
> - `onclick` å®ç°è·³è½¬é¢„è§ˆé¡µ
> - å“åº”å¼å¸ƒå±€é€‚é…ç§»åŠ¨ç«¯

---

## ğŸš€ ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨åº”ç”¨

ç„¶åè¿è¡Œä¸»ç±»å¯åŠ¨ Tio-Boot åº”ç”¨ã€‚

è®¿é—®åœ°å€ï¼š`http://localhost:8080/`

---

## âœ… æ€»ç»“

é€šè¿‡æœ¬æ¬¡å®è·µï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†ï¼š

- ä½¿ç”¨ **Tio-Boot** å¿«é€Ÿæ­å»º Web æœåŠ¡
- åˆ©ç”¨ **Java-DB** å®Œæˆæ•°æ®åº“äº¤äº’
- ç»“åˆ **Enjoy æ¨¡æ¿å¼•æ“** å®ç°åŠ¨æ€é¡µé¢æ¸²æŸ“
- è®¾è®¡å‡ºç¾è§‚ä¸”å“åº”å¼çš„å‰ç«¯ç•Œé¢

è¿™å¥—æŠ€æœ¯ç»„åˆéå¸¸é€‚åˆä¸­å°è§„æ¨¡é¡¹ç›®çš„å¿«é€Ÿå¼€å‘ï¼Œå°¤å…¶é€‚ç”¨äºå†…å®¹å‹ç½‘ç«™ã€æ•™è‚²å¹³å°ã€çŸ¥è¯†ç®¡ç†ç³»ç»Ÿç­‰åœºæ™¯ã€‚

---

ğŸ“Œ **å…³é”®è¯**ï¼šTio-Boot, Java-DB, Enjoy, æ¨¡æ¿å¼•æ“, å“åº”å¼è®¾è®¡, æ•°æ®é©±åŠ¨é¡µé¢, å­¦ä¹ å¹³å°

--- 

âœ… **å®Œæˆï¼** ä½ ç°åœ¨å¯ä»¥åŸºäºæ­¤æ¡†æ¶ç»§ç»­æ‰©å±•æ›´å¤šåŠŸèƒ½ï¼Œæ‰“é€ å±äºä½ çš„æ™ºèƒ½å­¦ä¹ ç³»ç»Ÿã€‚